{% if description != blank %}
<div class="productView-moreItem productView-moreItem-description">
  <div class="ew-product-description">
    <div class="description-text">
      {{ description }}
    </div>

    <button class="toggle-description-btn" type="button">Read more</button>
  </div>

  <style>
    .description-text {
      max-height: 300px; /* collapsed state */
      overflow: hidden;
      transition: max-height 0.3s ease;
    }

    .description-text.expanded {
      max-height: none; /* expanded state */
    }

    .toggle-description-btn {
      background: none;
      border: none;
      color: #007acc;
      cursor: pointer;
      font-weight: 500;
      margin-top: 8px;
      padding: 0;
    }

    .toggle-description-btn:hover {
      text-decoration: underline;
    }
  </style>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const desc = document.querySelector(".ew-product-description .description-text");
  const btn = document.querySelector(".ew-product-description .toggle-description-btn");

  if (!desc || !btn) return;

  // First: temporarily expand to measure full height
  desc.classList.add("expanded");
  const fullHeight = desc.scrollHeight;

  // Collapse again to measure collapsed height
  desc.classList.remove("expanded");
  const collapsedHeight = desc.scrollHeight;

  // If full height is NOT larger â†’ hide button, keep expanded
  if (fullHeight <= collapsedHeight + 5) {
    desc.classList.add("expanded");
    btn.style.display = "none";
    return;
  }

  // Enable toggle behavior
  btn.addEventListener("click", () => {
    desc.classList.toggle("expanded");
    btn.textContent = desc.classList.contains("expanded")
      ? "Read less"
      : "Read more";
  });
});
</script>


</div>
{% endif %}
