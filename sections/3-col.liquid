{% comment %}
  Section: Creative Blob Grid (OS 2.0)
  - 4 tiles with image + background + optional blob overlays
  - Full width layout
{% endcomment %}

<section class="creative-blob-grid-ai">
  <div class="creative-blob-grid-ai__grid-ai">
    {% for block in section.blocks %}
      {% assign has_link = false %}
      {% if block.settings.link != blank %}
        {% assign has_link = true %}
      {% endif %}

      <div
        class="creative-blob-grid-ai__item-ai"
        style="--tile-bg-ai: {{ block.settings.bg_color }};"
        {{ block.shopify_attributes }}
      >
        {% if has_link %}
          <a class="creative-blob-grid-ai__link-ai" href="{{ block.settings.link }}">
        {% endif %}

          <div class="creative-blob-grid-ai__media-ai">
            {% if block.settings.image != blank %}
              {{
                block.settings.image
                | image_url: width: 1600
                | image_tag:
                  loading: 'lazy',
                  class: 'creative-blob-grid-ai__img-ai',
                  sizes: '(min-width: 990px) 25vw, (min-width: 750px) 50vw, 100vw',
                  widths: '450, 750, 1100, 1600'
              }}
            {% else %}
              <div class="creative-blob-grid-ai__placeholder-ai">
                {{ 'image' | placeholder_svg_tag }}
              </div>
            {% endif %}

            {% if section.settings.enable_blobs %}
              {% assign blob_color = block.settings.blob_color | default: '#F5F5F5' %}
              <span class="creative-blob-grid-ai__blob-ai creative-blob-grid-ai__blob-ai--one-ai" style="--blob-color-ai: {{ blob_color }};"></span>
              <span class="creative-blob-grid-ai__blob-ai creative-blob-grid-ai__blob-ai--two-ai" style="--blob-color-ai: {{ blob_color }};"></span>
              <span class="creative-blob-grid-ai__blob-ai creative-blob-grid-ai__blob-ai--three-ai" style="--blob-color-ai: {{ blob_color }};"></span>
            {% endif %}
          </div>

        {% if has_link %}
          </a>
        {% endif %}
      </div>
    {% endfor %}
  </div>
</section>

<style>
  .creative-blob-grid-ai {
    width: 100%;
    margin: 0;
  }

  .creative-blob-grid-ai__grid-ai {
    display: grid;
    grid-template-columns: repeat(4, minmax(0, 1fr));
    gap: {{ section.settings.gap }}px;
    padding: {{ section.settings.outer_padding }}px;
  }

  .creative-blob-grid-ai__item-ai {
    background: var(--tile-bg-ai, #f2f2f2);
    border-radius: {{ section.settings.radius }}px;
    overflow: hidden;
    position: relative;
  }

  .creative-blob-grid-ai__link-ai {
    display: block;
    text-decoration: none;
    color: inherit;
  }

  .creative-blob-grid-ai__media-ai {
    position: relative;
    width: 100%;
    aspect-ratio: {{ section.settings.aspect_ratio }};
    overflow: hidden;
  }

  .creative-blob-grid-ai__img-ai {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transform: scale(1);
    transition: transform 0.4s ease;
    display: block;
  }

  .creative-blob-grid-ai__item-ai:hover .creative-blob-grid-ai__img-ai {
    transform: scale(1.05);
  }

  .creative-blob-grid-ai__placeholder-ai svg {
    width: 100%;
    height: 100%;
    display: block;
  }

  /* Blobs */
  .creative-blob-grid-ai__blob-ai {
    position: absolute;
    background: var(--blob-color-ai, #f5f5f5);
    opacity: {{ section.settings.blob_opacity | divided_by: 100.0 }};
    border-radius: 999px;
    pointer-events: none;
    filter: blur({{ section.settings.blob_blur }}px);
    transform: rotate(0deg);
  }

  /* Top-right-ish blob */
  .creative-blob-grid-ai__blob-ai--one-ai {
    width: 58%;
    height: 48%;
    top: -10%;
    right: -12%;
    border-radius: 55% 45% 60% 40% / 55% 45% 55% 45%;
    transform: rotate(12deg);
  }

  /* Center blob */
  .creative-blob-grid-ai__blob-ai--two-ai {
    width: 70%;
    height: 58%;
    top: 18%;
    left: 10%;
    border-radius: 40% 60% 45% 55% / 55% 45% 40% 60%;
    transform: rotate(-8deg);
  }

  /* Bottom-left-ish blob */
  .creative-blob-grid-ai__blob-ai--three-ai {
    width: 55%;
    height: 45%;
    bottom: -12%;
    left: -15%;
    border-radius: 60% 40% 55% 45% / 45% 55% 60% 40%;
    transform: rotate(18deg);
  }

  /* Responsive */
  @media (max-width: 989px) {
    .creative-blob-grid-ai__grid-ai {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }
  }

 @media (max-width: 749px) {
  .creative-blob-grid-ai__grid-ai {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }
}
</style>

{% schema %}
{
  "name": "Creative Blob Grid",
  "settings": [
    {
      "type": "checkbox",
      "id": "enable_blobs",
      "label": "Enable blob overlays",
      "default": true
    },
    {
      "type": "range",
      "id": "gap",
      "label": "Gap between tiles (px)",
      "min": 0,
      "max": 30,
      "step": 1,
      "default": 10
    },
    {
      "type": "range",
      "id": "outer_padding",
      "label": "Outer padding (px)",
      "min": 0,
      "max": 40,
      "step": 1,
      "default": 0
    },
    {
      "type": "range",
      "id": "radius",
      "label": "Tile corner radius (px)",
      "min": 0,
      "max": 30,
      "step": 1,
      "default": 0
    },
    {
      "type": "text",
      "id": "aspect_ratio",
      "label": "Aspect ratio (CSS value, e.g. 4 / 5)",
      "default": "4 / 5"
    },
    {
      "type": "range",
      "id": "blob_opacity",
      "label": "Blob opacity (%)",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 100
    },
    {
      "type": "range",
      "id": "blob_blur",
      "label": "Blob blur (px)",
      "min": 0,
      "max": 20,
      "step": 1,
      "default": 0
    }
  ],
  "blocks": [
    {
      "type": "tile",
      "name": "Tile",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "color",
          "id": "bg_color",
          "label": "Background color",
          "default": "#EDEDED"
        },
        {
          "type": "color",
          "id": "blob_color",
          "label": "Blob color",
          "default": "#F5F5F5"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Optional link"
        }
      ]
    }
  ],
  "max_blocks": 4,
  "presets": [
    {
      "name": "Creative Blob Grid",
      "blocks": [
        { "type": "tile" },
        { "type": "tile" },
        { "type": "tile" },
        { "type": "tile" }
      ]
    }
  ]
}
{% endschema %}
